{% extends 'base.html' %}

{% block content %}
<div class="container py-4">
    <h2 class="mb-4 text-center fw-bold">ðŸ“˜ Add New Logbook Entry</h2>

    <!-- âœ… Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <!-- âœ… Form -->
    <form method="POST" action="{{ url_for('main.logbook_entry') }}">
        <div class="row g-3">
            <!-- Trip Info -->
            <div class="col-md-4"><label>Date:</label><input type="date" name="date" class="form-control" value="{{ request.form.date or '' }}" required></div>
            <div class="col-md-4"><label>Trip No:</label><input type="text" name="trip_no" class="form-control" value="{{ request.form.trip_no or '' }}" required></div>
            <div class="col-md-4"><label>Consignee:</label><input type="text" name="consignee" class="form-control" value="{{ request.form.consignee or '' }}" required></div>

            <!-- Route Info -->
            <div class="col-md-4"><label>Terminal:</label><input type="text" name="terminal" class="form-control" value="{{ request.form.terminal or '' }}" required></div>
            <div class="col-md-4"><label>Destination:</label><input type="text" name="destination" class="form-control" value="{{ request.form.destination or '' }}" required></div>
            <div class="col-md-4"><label>Truck No:</label><input type="text" name="truck_no" class="form-control" value="{{ request.form.truck_no or '' }}" required></div>

            <!-- Dates -->
            <div class="col-md-4"><label>Pickup Date:</label><input type="date" name="pickup_date" class="form-control" value="{{ request.form.pickup_date or '' }}"></div>
            <div class="col-md-4"><label>Offloading Date:</label><input type="date" name="offloading_date" class="form-control" value="{{ request.form.offloading_date or '' }}"></div>

            <!-- Expenses -->
            <div class="col-md-4"><label>Fuel:</label><input type="number" step="0.01" name="fuel" class="form-control" value="{{ request.form.fuel or '' }}"></div>
            <div class="col-md-4"><label>Road Expense:</label><input type="number" step="0.01" name="road_expense" class="form-control" value="{{ request.form.road_expense or '' }}"></div>
            <div class="col-md-4"><label>Toll:</label><input type="number" step="0.01" name="toll" class="form-control" value="{{ request.form.toll or '' }}"></div>
            <div class="col-md-4"><label>Advance Payment:</label><input type="number" step="0.01" name="advance_payment" class="form-control" value="{{ request.form.advance_payment or '' }}"></div>

            <!-- Delivery -->
            <div class="col-md-4"><label>No of Containers:</label><input type="number" name="no_of_cont" class="form-control" value="{{ request.form.no_of_cont or '' }}"></div>
            <div class="col-md-4"><label>Unit Price:</label><input type="number" step="0.01" name="unit_price" class="form-control" value="{{ request.form.unit_price or '' }}"></div>
            <div class="col-md-4"><label>Rate:</label><input type="text" name="rate" class="form-control" value="{{ request.form.rate or '' }}"></div>

            <!-- Invoice & Payment -->
            <div class="col-md-4"><label>Invoice Date:</label><input type="date" name="invoice_date" class="form-control" value="{{ request.form.invoice_date or '' }}"></div>
            <div class="col-md-4"><label>Payment Received Date:</label><input type="date" name="payment_rec_date" class="form-control" value="{{ request.form.payment_rec_date or '' }}"></div>
            <div class="col-md-4">
                <label>Mode of Payment:</label>
                <select name="mode_of_payment" class="form-select">
                    <option value="">-- Select --</option>
                    <option value="Cash" {% if request.form.mode_of_payment == 'Cash' %}selected{% endif %}>Cash</option>
                    <option value="Bank Transfer" {% if request.form.mode_of_payment == 'Bank Transfer' %}selected{% endif %}>Bank Transfer</option>
                    <option value="Cheque" {% if request.form.mode_of_payment == 'Cheque' %}selected{% endif %}>Cheque</option>
                    <option value="Mobile Money" {% if request.form.mode_of_payment == 'Mobile Money' %}selected{% endif %}>Mobile Money</option>
                </select>
            </div>

            <!-- Remarks -->
            <div class="col-md-12">
                <label>Remarks:</label>
                <textarea name="remarks" rows="2" class="form-control">{{ request.form.remarks or '' }}</textarea>
            </div>
        </div>

        <!-- Submit Button -->
        <div class="mt-4 text-center">
            <button type="submit" class="btn btn-primary px-5">âž• Submit Entry</button>
        </div>
    </form>
</div>
{% endblock %}
